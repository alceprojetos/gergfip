SET TALK OFF
SET ECHO OFF
SET STEP OFF
SET DATE BRIT
SET CENT ON
*
CLEAR
*
WMESANO:= '  /    '
*
@ 24,65 GET WMESANO PICT '99/9999' WHEN MENS('Entre com o MES/ANO da GEFIP. <ESC> Retorna: ')
READ
*
IF LASTKEY() = 27
   QUIT
ENDIF
*
WMES:= SUBS(WMESANO,1,2)
WMESEXT:= SUBS([JANFEVMARABRMAIJUNJULAGOSETOUTNOVDEZ],VAL(WMES) * 3 - 2,3)
WANO:= SUBS(WMESANO,6,2)
WANOEXT:= SUBS(WMESANO,4,4)
WINSS:= [INS] + WMESEXT + WANO
WCAMPOMES:= WMESEXT + WANO
*
SELE 1
USE &WINSS
PACK
*
CLOSE DATA
*
USE &WINSS
REPL DATDEMI WITH [16]+WMES+WANOEXT FOR EXONERADO = [S]
REPL REMCOM13 WITH REMSEM13 FOR EXONERADO = [S]
REPL REMSEM13 WITH [] FOR EXONERADO = [S]
REPL DEZ13 WITH &WCAMPOMES FOR EXONERADO = [S]
REPL &WCAMPOMES WITH 0.00 FOR EXONERADO = [S]
*
INDE ON PISPASEP + DATADM TO &WINSS
USE
*
USE &WINSS INDE &WINSS
*
SUM ALL TOTSALFAM TO WTOTSALFAM
SUM ALL TOTSALMAT TO WTOTSALMAT
*
WTOTSALFAM:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(STR(WTOTSALFAM * 100,15))))) + TRIM(LTRIM(STR(WTOTSALFAM * 100,15)))
WTOTSALMAT:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(STR(WTOTSALMAT * 100,15))))) + TRIM(LTRIM(STR(WTOTSALMAT * 100,15)))
*
GO TOP
*
WCABECA:= [30106750525000120               ]
WCABECA1:= [32106750525000120               ]
WBRANCO1:= [                    ]
*         12345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678
*                  1         2         3         4         5         6         7         8         9
WBRANCO3:=[                                                                                                  ]
*          1234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890
*                   1         2         3         4         5         6         7         8         9         1
WBRANCO4:=[                                                                                                    ]
*
* FOLHA = 00
*
SET FILTER TO FF = [00]
GO TOP
*
SET CONS OFF
SET PRIN TO SEFIP.00
SET PRIN ON
*
??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  ISAURA P D NOGUEIRA AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773746ANDRESAPIRANGA@HOTMAIL.COM                                  ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
*
DO WHILE !EOF()
   IF STATUS <> [VAI]
      SKIP
      *
      LOOP
   ENDIF
   *
   WREMSEM13:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(REMSEM13)))) + TRIM(LTRIM(REMSEM13))
   WREMCOM13:= SUBS([000000000000000],1,15 - LEN(TRIM(LTRIM(REMCOM13)))) + TRIM(LTRIM(REMCOM13))
   *
   IF MVINC = [S]
      WBRANCO2:= [  05]
      WDESCINSS:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(DESCONINSS)))) + TRIM(LTRIM(DESCONINSS))
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   WDESCINSS + [000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   WDESCINSS + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ELSE
      WBRANCO2:= [    ]  
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   [000000000000000000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   [000000000000000] + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ENDIF
   *
   IF LEN(TRIM(LTRIM(DATADM))) <> 0
      ?WCABECA + PISPASEP + DATADM + [12] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ELSE
      ?WCABECA + PISPASEP + DATADM + [13] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ENDIF
   ??
   *
   IF EXONERADO = [S]
      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [L ] + DATDEMI + [N] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
   ENDIF
   ??
   *
   * FALECIMENTO COM CODIGO IGUAL A "0" SEM ACIDENTE DE TRABALHO, COM "1" ACIDENTE DE TRABALHO
*   IF FALECIDO = [0]
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S2] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ELSE
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S3] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ENDIF
*   ??
   *
   SKIP
ENDDO
*
?[90999999999999999999999999999999999999999999999999999                                                                                                                                                                                                                                                                                                                  *]
*
SET PRIN OFF
SET PRIN TO
*
* FOLHA = 03
*
SET FILTER TO FF = [03]
GO TOP
*
SET CONS OFF
SET PRIN TO SEFIP.03
SET PRIN ON
*
??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  ISAURA P D NOGUEIRA AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773746ANDRESAPIRANGA@HOTMAIL.COM                                  ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
**??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  AUREA MARIA PONTES  AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773732ANDRE@AL.CE.GOV.BR                                          ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
**?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
*
DO WHILE !EOF()
   IF STATUS <> [VAI]
      SKIP
      *
      LOOP
   ENDIF
   *
   WREMSEM13:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(REMSEM13)))) + TRIM(LTRIM(REMSEM13))
   WREMCOM13:= SUBS([000000000000000],1,15 - LEN(TRIM(LTRIM(REMCOM13)))) + TRIM(LTRIM(REMCOM13))
   *
   IF MVINC = [S]
      WBRANCO2:= [  05]
      WDESCINSS:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(DESCONINSS)))) + TRIM(LTRIM(DESCONINSS))
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   WDESCINSS + [000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   WDESCINSS + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ELSE
      WBRANCO2:= [    ]  
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   [000000000000000000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   [000000000000000] + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ENDIF
   *
   IF LEN(TRIM(LTRIM(DATADM))) <> 0
      ?WCABECA + PISPASEP + DATADM + [12] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ELSE
      ?WCABECA + PISPASEP + DATADM + [13] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ENDIF
   ??
   *
   IF EXONERADO = [S]
      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [L ] + DATDEMI + [N] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
   ENDIF
   ??
   *
   * FALECIMENTO COM CODIGO IGUAL A "0" SEM ACIDENTE DE TRABALHO, COM "1" ACIDENTE DE TRABALHO
*   IF FALECIDO = [0]
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S2] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ELSE
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S3] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ENDIF
*   ??
   *
   SKIP
ENDDO
*
?[90999999999999999999999999999999999999999999999999999                                                                                                                                                                                                                                                                                                                  *]
*
SET PRIN OFF
SET PRIN TO
*
* FOLHA = 01
*
SET FILTER TO FF = [01]
GO TOP
*
SET CONS OFF
SET PRIN TO SEFIP.01
SET PRIN ON
*
??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  ISAURA P D NOGUEIRA AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773746ANDRESAPIRANGA@HOTMAIL.COM                                  ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
**??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  AUREA MARIA PONTES  AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773732ANDRE@AL.CE.GOV.BR                                          ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
**?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
*
DO WHILE !EOF()
   IF STATUS <> [VAI]
      SKIP
      *
      LOOP
   ENDIF
   *
   WREMSEM13:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(REMSEM13)))) + TRIM(LTRIM(REMSEM13))
   WREMCOM13:= SUBS([000000000000000],1,15 - LEN(TRIM(LTRIM(REMCOM13)))) + TRIM(LTRIM(REMCOM13))
   *
   IF MVINC = [S]
      WBRANCO2:= [  05]
      WDESCINSS:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(DESCONINSS)))) + TRIM(LTRIM(DESCONINSS))
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   WDESCINSS + [000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   WDESCINSS + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ELSE
      WBRANCO2:= [    ]  
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   [000000000000000000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   [000000000000000] + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ENDIF
   *
   IF LEN(TRIM(LTRIM(DATADM))) <> 0
      ?WCABECA + PISPASEP + DATADM + [12] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ELSE
      ?WCABECA + PISPASEP + DATADM + [13] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ENDIF
   ??
   *
   IF EXONERADO = [S]
      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [L ] + DATDEMI + [N] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
   ENDIF
   ??
   *
   * FALECIMENTO COM CODIGO IGUAL A "0" SEM ACIDENTE DE TRABALHO, COM "1" ACIDENTE DE TRABALHO
*   IF FALECIDO = [0]
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S2] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ELSE
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S3] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ENDIF
*   ??
   *
   SKIP
ENDDO
*
?[90999999999999999999999999999999999999999999999999999                                                                                                                                                                                                                                                                                                                  *]
*
SET PRIN OFF
SET PRIN TO
*
* FOLHA = 08
*
SET FILTER TO FF = [08]
GO TOP
*
SET CONS OFF
SET PRIN TO SEFIP.08
SET PRIN ON
*
??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  ISAURA P D NOGUEIRA AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773746ANDRESAPIRANGA@HOTMAIL.COM                                  ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
**??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  AUREA MARIA PONTES  AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773732ANDRE@AL.CE.GOV.BR                                          ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
***?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
*
DO WHILE !EOF()
   IF STATUS <> [VAI]
      SKIP
      *
      LOOP
   ENDIF
   *
   WREMSEM13:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(REMSEM13)))) + TRIM(LTRIM(REMSEM13))
   WREMCOM13:= SUBS([000000000000000],1,15 - LEN(TRIM(LTRIM(REMCOM13)))) + TRIM(LTRIM(REMCOM13))
   *
   IF MVINC = [S]
      WBRANCO2:= [  05]
      WDESCINSS:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(DESCONINSS)))) + TRIM(LTRIM(DESCONINSS))
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   WDESCINSS + [000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   WDESCINSS + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ELSE
      WBRANCO2:= [    ]  
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   [000000000000000000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   [000000000000000] + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ENDIF
   *
   IF LEN(TRIM(LTRIM(DATADM))) <> 0
      ?WCABECA + PISPASEP + DATADM + [12] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ELSE
      ?WCABECA + PISPASEP + DATADM + [13] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ENDIF
   ??
   *
   IF EXONERADO = [S]
      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [L ] + DATDEMI + [N] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
   ENDIF
   ??
   *
   * FALECIMENTO COM CODIGO IGUAL A "0" SEM ACIDENTE DE TRABALHO, COM "1" ACIDENTE DE TRABALHO
*   IF FALECIDO = [0]
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S2] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ELSE
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S3] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ENDIF
*   ??
   *
   SKIP
ENDDO
*
?[90999999999999999999999999999999999999999999999999999                                                                                                                                                                                                                                                                                                                  *]
*
SET PRIN OFF
SET PRIN TO
*
* FOLHA = 12
*
SET FILTER TO FF = [12]
GO TOP
*
SET CONS OFF
SET PRIN TO SEFIP.12
SET PRIN ON
*
??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  ISAURA P D NOGUEIRA AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773746ANDRESAPIRANGA@HOTMAIL.COM                                  ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
**??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  AUREA MARIA PONTES  AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773732ANDRE@AL.CE.GOV.BR                                          ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
**?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
*
DO WHILE !EOF()
   IF STATUS <> [VAI]
      SKIP
      *
      LOOP
   ENDIF
   *
   WREMSEM13:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(REMSEM13)))) + TRIM(LTRIM(REMSEM13))
   WREMCOM13:= SUBS([000000000000000],1,15 - LEN(TRIM(LTRIM(REMCOM13)))) + TRIM(LTRIM(REMCOM13))
   *
   IF MVINC = [S]
      WBRANCO2:= [  05]
      WDESCINSS:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(DESCONINSS)))) + TRIM(LTRIM(DESCONINSS))
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   WDESCINSS + [000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   WDESCINSS + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ELSE
      WBRANCO2:= [    ]  
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   [000000000000000000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   [000000000000000] + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ENDIF
   *
   IF LEN(TRIM(LTRIM(DATADM))) <> 0
      ?WCABECA + PISPASEP + DATADM + [12] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ELSE
      ?WCABECA + PISPASEP + DATADM + [13] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ENDIF
   ??
   *
   IF EXONERADO = [S]
      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [L ] + DATDEMI + [N] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
   ENDIF
   ??
   *
   * FALECIMENTO COM CODIGO IGUAL A "0" SEM ACIDENTE DE TRABALHO, COM "1" ACIDENTE DE TRABALHO
*   IF FALECIDO = [0]
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S2] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ELSE
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S3] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ENDIF
*   ??
   *
   SKIP
ENDDO
*
?[90999999999999999999999999999999999999999999999999999                                                                                                                                                                                                                                                                                                                  *]
*
SET PRIN OFF
SET PRIN TO
*
* FOLHA = SP
*
SET FILTER TO MATR = [ ]
GO TOP
*
SET CONS OFF
SET PRIN TO SEFIP.SP
SET PRIN ON
*
??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  ISAURA P D NOGUEIRA AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773746ANDRESAPIRANGA@HOTMAIL.COM                                  ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
**??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  AUREA MARIA PONTES  AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773732ANDRE@AL.CE.GOV.BR                                          ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
**?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
*
DO WHILE !EOF()
   IF STATUS <> [VAI]
      SKIP
      *
      LOOP
   ENDIF
   *
   WREMSEM13:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(REMSEM13)))) + TRIM(LTRIM(REMSEM13))
   WREMCOM13:= SUBS([000000000000000],1,15 - LEN(TRIM(LTRIM(REMCOM13)))) + TRIM(LTRIM(REMCOM13))
   *
   IF MVINC = [S]
      WBRANCO2:= [  05]
      WDESCINSS:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(DESCONINSS)))) + TRIM(LTRIM(DESCONINSS))
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   WDESCINSS + [000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   WDESCINSS + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ELSE
      WBRANCO2:= [    ]  
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   [000000000000000000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   [000000000000000] + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ENDIF
   *
   IF LEN(TRIM(LTRIM(DATADM))) <> 0
      ?WCABECA + PISPASEP + DATADM + [12] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ELSE
      ?WCABECA + PISPASEP + DATADM + [13] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ENDIF
   ??
   *
   IF EXONERADO = [S]
      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [L ] + DATDEMI + [N] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
   ENDIF
   ??
   *
   * FALECIMENTO COM CODIGO IGUAL A "0" SEM ACIDENTE DE TRABALHO, COM "1" ACIDENTE DE TRABALHO
*   IF FALECIDO = [0]
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S2] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ELSE
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S3] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ENDIF
*   ??
   *
   SKIP
ENDDO
*
?[90999999999999999999999999999999999999999999999999999                                                                                                                                                                                                                                                                                                                  *]
*
SET PRIN OFF
SET PRIN TO
*
* TODAS AS FOLHAS
*
SET FILTER TO
GO TOP
*
SET CONS OFF
SET PRIN TO SEFIP.RE
SET PRIN ON
*
??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  ISAURA P D NOGUEIRA AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773746ANDRESAPIRANGA@HOTMAIL.COM                                  ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
**??[00                                                   1106750525000120ASSEMBLEIA LEGISLATIVA DO CE  AUREA MARIA PONTES  AV DESEMBAGADOR MOREIRA 2807                      DIONISIO TORRES     60170002FORTALEZA           CE008532773732ANDRE@AL.CE.GOV.BR                                          ] + WANOEXT + WMES + [1151         1               106750525000120                  *]
**?[10106750525000120000000000000000000000000000000000000ASSEMBLEIA LEGISLATIVA DO CEARA         AV DESEMBARGADOR MOREIRA 2807                     DIONISIO TORRES     60170002FORTALEZA           CE008532773732N7511600N100158200002402     ] + WTOTSALFAM + WTOTSALMAT + [000000000000000000000000000000                000000000000000000000000000000000000000000000    *]
*
DO WHILE !EOF()
   IF STATUS <> [VAI]
      SKIP
      *
      LOOP
   ENDIF
   *
   WREMSEM13:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(REMSEM13)))) + TRIM(LTRIM(REMSEM13))
   WREMCOM13:= SUBS([000000000000000],1,15 - LEN(TRIM(LTRIM(REMCOM13)))) + TRIM(LTRIM(REMCOM13))
   *
   IF MVINC = [S]
      WBRANCO2:= [  05]
      WDESCINSS:= SUBS([0000000000000000],1,15 - LEN(TRIM(LTRIM(DESCONINSS)))) + TRIM(LTRIM(DESCONINSS))
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   WDESCINSS + [000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   WDESCINSS + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ELSE
      WBRANCO2:= [    ]  
      *           123456789012345678901234567890123456789012345678901234567890
      *                    1         2         3         4         5         6
      IF EXONERADO <> [S]
         WZERO1:=   [000000000000000000000000000000000000000000000000000000000000]
      ELSE
         WZERO1:=   [000000000000000] + [000000000000000] + WREMCOM13 + [000000000000000]
      ENDIF
   ENDIF
   *
   IF LEN(TRIM(LTRIM(DATADM))) <> 0
      ?WCABECA + PISPASEP + DATADM + [12] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ELSE
      ?WCABECA + PISPASEP + DATADM + [13] + NOME + MATRICULA + WBRANCO1 + DATNASC + [05199] + WREMSEM13 + WREMCOM13 + WBRANCO2 + WZERO1 + WBRANCO3 + [*]
   ENDIF
   ??
   *
   IF EXONERADO = [S]
      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [L ] + DATDEMI + [N] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
   ENDIF
   ??
   *
   * FALECIMENTO COM CODIGO IGUAL A "0" SEM ACIDENTE DE TRABALHO, COM "1" ACIDENTE DE TRABALHO
*   IF FALECIDO = [0]
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S2] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ELSE
*      ?WCABECA1 + PISPASEP + DATADM + [12] + NOME + [S3] + DATFALEC + [ ] + WBRANCO4 + WBRANCO4 + [                         ] + [*]
*   ENDIF
*   ??
   *
   SKIP
ENDDO
*
?[90999999999999999999999999999999999999999999999999999                                                                                                                                                                                                                                                                                                                  *]
*
SET PRIN OFF
SET PRIN TO
*

CLOSE DATA
*
*!DEL *.NTX
*COPY FILE SEFIP.RE TO C:\SEFIP.RE
*
CLEAR ALL
CLEAR
*
QUIT

//////////////////////////////////////
func mens(wstr,wpara,wlin,wcor,waviso)
//////////////////////////////////////
  local cor:= if(wcor = nil .or. !iscolor(),setcolor('w+/b'),setcolor(wcor)),i,j,k
  *
  setcursor(0)
  *
  if waviso # nil; tone(450,7); endif
  *
  if wpara = nil; wpara:= .f.; endif
  *
  if wlin = nil; wlin:= 24; endif
  *
  K:= setcolor('n/n'); @ wlin,0; setcolor(k)
  *
  for i:= 1 to len(wstr)/2
      @ wlin,40 - i say subs(wstr,1,i)
      @ wlin,40 say subs(wstr,len(wstr) - i + 1,i)
      *
      j:= 0; do while j++ # 15; enddo
  next
  *
  @ wlin,0; @ wlin,(80 - len(wstr)) / 2 say wstr
  *
  if wpara; inkey(0); endif
  *
  setcolor(cor); setcursor(1)
  *
  return(.t.)
